\hypertarget{kpf_8c}{}\doxysection{/\+Users/cryptic/source/x8\+A4/\+Kernel/kpf.c File Reference}
\label{kpf_8c}\index{/Users/cryptic/source/x8A4/Kernel/kpf.c@{/Users/cryptic/source/x8A4/Kernel/kpf.c}}


This file is for all kernel kpf related code.  


{\ttfamily \#include $<$x8\+A4/\+Kernel/nvram.\+h$>$}\newline
{\ttfamily \#include $<$x8\+A4/\+Kernel/kpf.\+h$>$}\newline
{\ttfamily \#include $<$x8\+A4/\+Logger/logger.\+h$>$}\newline
{\ttfamily \#include $<$x8\+A4/x8\+A4.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{kpf_8c_adbf814b3fa52d2730e72dc37d61657f7}{xpf\+\_\+setup\+\_\+fileset\+\_\+sections}} (void)
\begin{DoxyCompactList}\small\item\em Sets up XPF fileset kernel sections for the IMG4 Kext. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{kpf_8c_ab93be6bab292855c6ec2125e558b08d9}\label{kpf_8c_ab93be6bab292855c6ec2125e558b08d9}} 
void {\bfseries xpf\+\_\+free\+\_\+fileset\+\_\+sections} (void)
\begin{DoxyCompactList}\small\item\em Frees XPF fileset kernel sections for the IMG4 Kext. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{kpf_8c_a8c1619054a08b80e21515bfa4f8e0619}{xpf\+\_\+find\+\_\+nonce\+\_\+slots\+\_\+array}} (void)
\begin{DoxyCompactList}\small\item\em XPF Kernel patchfind the nonce slots array. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{kpf_8c_af50f848ada18ccf686f6fee4e8e26447}{xpf\+\_\+find\+\_\+nonce\+\_\+domains\+\_\+array}} (void)
\begin{DoxyCompactList}\small\item\em XPF Kernel patchfind the nonce domains array. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{kpf_8c_a9f0751b9c8a922a8c68b83e685e0547e}{xpf\+\_\+find\+\_\+nonce\+\_\+slots\+\_\+array\+\_\+length}} (void)
\begin{DoxyCompactList}\small\item\em XPF Kernel patchfind the nonce slots array length. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{kpf_8c_a48412698a4f0f7f67035fec92ae5fb02}{xpf\+\_\+find\+\_\+nonce\+\_\+domains\+\_\+array\+\_\+length}} (uint64\+\_\+t nonce\+\_\+domains\+\_\+array\+\_\+addr)
\begin{DoxyCompactList}\small\item\em XPF Kernel patchfind the nonce domains array length. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{kpf_8c_add6c4c7e44f513399834371294dd90ac}{xpf\+\_\+find\+\_\+cryptex\+\_\+boot\+\_\+domain\+\_\+index}} (uint64\+\_\+t nonce\+\_\+domains\+\_\+array\+\_\+addr, int nonce\+\_\+domains\+\_\+array\+\_\+length)
\begin{DoxyCompactList}\small\item\em Iterate each nonce domains array entry until cryptex boot is found. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{kpf_8c_ac1a1340d0cd651a31552d7abe233bce0}\label{kpf_8c_ac1a1340d0cd651a31552d7abe233bce0}} 
PFSection $\ast$ {\bfseries apple\+\_\+image4\+\_\+fileset\+\_\+sections} \mbox{[}3\mbox{]} = \{0\}
\item 
\mbox{\Hypertarget{kpf_8c_aec23fbac09bbbce61a74c0fb82428ae0}\label{kpf_8c_aec23fbac09bbbce61a74c0fb82428ae0}} 
uint64\+\_\+t {\bfseries kpf\+\_\+nonce\+\_\+domains\+\_\+cached} = 0
\item 
\mbox{\Hypertarget{kpf_8c_a739bb2e1cbaa2687edd449c3b58d4801}\label{kpf_8c_a739bb2e1cbaa2687edd449c3b58d4801}} 
int {\bfseries kpf\+\_\+nonce\+\_\+domains\+\_\+length\+\_\+cached} = 0
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file is for all kernel kpf related code. 

\begin{DoxyAuthor}{Author}
Cryptiiiic 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+0.\+0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2024-\/04-\/27
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2024 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{kpf_8c_add6c4c7e44f513399834371294dd90ac}\label{kpf_8c_add6c4c7e44f513399834371294dd90ac}} 
\index{kpf.c@{kpf.c}!xpf\_find\_cryptex\_boot\_domain\_index@{xpf\_find\_cryptex\_boot\_domain\_index}}
\index{xpf\_find\_cryptex\_boot\_domain\_index@{xpf\_find\_cryptex\_boot\_domain\_index}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_find\_cryptex\_boot\_domain\_index()}{xpf\_find\_cryptex\_boot\_domain\_index()}}
{\footnotesize\ttfamily int xpf\+\_\+find\+\_\+cryptex\+\_\+boot\+\_\+domain\+\_\+index (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{nonce\+\_\+domains\+\_\+array\+\_\+addr,  }\item[{int}]{nonce\+\_\+domains\+\_\+array\+\_\+length }\end{DoxyParamCaption})}



Iterate each nonce domains array entry until cryptex boot is found. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nonce\+\_\+domains\+\_\+array\+\_\+addr} & \\
\hline
\mbox{\texttt{ in}}  & {\em nonce\+\_\+domains\+\_\+array\+\_\+length} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Index of cryptex boot entry 
\end{DoxyReturn}
\mbox{\Hypertarget{kpf_8c_af50f848ada18ccf686f6fee4e8e26447}\label{kpf_8c_af50f848ada18ccf686f6fee4e8e26447}} 
\index{kpf.c@{kpf.c}!xpf\_find\_nonce\_domains\_array@{xpf\_find\_nonce\_domains\_array}}
\index{xpf\_find\_nonce\_domains\_array@{xpf\_find\_nonce\_domains\_array}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_find\_nonce\_domains\_array()}{xpf\_find\_nonce\_domains\_array()}}
{\footnotesize\ttfamily uint64\+\_\+t xpf\+\_\+find\+\_\+nonce\+\_\+domains\+\_\+array (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



XPF Kernel patchfind the nonce domains array. 

\begin{DoxyReturn}{Returns}
Address of nonce domains array 
\end{DoxyReturn}
\mbox{\Hypertarget{kpf_8c_a48412698a4f0f7f67035fec92ae5fb02}\label{kpf_8c_a48412698a4f0f7f67035fec92ae5fb02}} 
\index{kpf.c@{kpf.c}!xpf\_find\_nonce\_domains\_array\_length@{xpf\_find\_nonce\_domains\_array\_length}}
\index{xpf\_find\_nonce\_domains\_array\_length@{xpf\_find\_nonce\_domains\_array\_length}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_find\_nonce\_domains\_array\_length()}{xpf\_find\_nonce\_domains\_array\_length()}}
{\footnotesize\ttfamily int xpf\+\_\+find\+\_\+nonce\+\_\+domains\+\_\+array\+\_\+length (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{nonce\+\_\+domains\+\_\+array\+\_\+addr }\end{DoxyParamCaption})}



XPF Kernel patchfind the nonce domains array length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nonce\+\_\+domains\+\_\+array\+\_\+addr} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Length of the nonce domains array 
\end{DoxyReturn}
\mbox{\Hypertarget{kpf_8c_a8c1619054a08b80e21515bfa4f8e0619}\label{kpf_8c_a8c1619054a08b80e21515bfa4f8e0619}} 
\index{kpf.c@{kpf.c}!xpf\_find\_nonce\_slots\_array@{xpf\_find\_nonce\_slots\_array}}
\index{xpf\_find\_nonce\_slots\_array@{xpf\_find\_nonce\_slots\_array}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_find\_nonce\_slots\_array()}{xpf\_find\_nonce\_slots\_array()}}
{\footnotesize\ttfamily uint64\+\_\+t xpf\+\_\+find\+\_\+nonce\+\_\+slots\+\_\+array (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



XPF Kernel patchfind the nonce slots array. 

\begin{DoxyReturn}{Returns}
Address of nonce slots array 
\end{DoxyReturn}
\mbox{\Hypertarget{kpf_8c_a9f0751b9c8a922a8c68b83e685e0547e}\label{kpf_8c_a9f0751b9c8a922a8c68b83e685e0547e}} 
\index{kpf.c@{kpf.c}!xpf\_find\_nonce\_slots\_array\_length@{xpf\_find\_nonce\_slots\_array\_length}}
\index{xpf\_find\_nonce\_slots\_array\_length@{xpf\_find\_nonce\_slots\_array\_length}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_find\_nonce\_slots\_array\_length()}{xpf\_find\_nonce\_slots\_array\_length()}}
{\footnotesize\ttfamily int xpf\+\_\+find\+\_\+nonce\+\_\+slots\+\_\+array\+\_\+length (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



XPF Kernel patchfind the nonce slots array length. 

\begin{DoxyReturn}{Returns}
Length of the nonce domains array 
\end{DoxyReturn}
\mbox{\Hypertarget{kpf_8c_adbf814b3fa52d2730e72dc37d61657f7}\label{kpf_8c_adbf814b3fa52d2730e72dc37d61657f7}} 
\index{kpf.c@{kpf.c}!xpf\_setup\_fileset\_sections@{xpf\_setup\_fileset\_sections}}
\index{xpf\_setup\_fileset\_sections@{xpf\_setup\_fileset\_sections}!kpf.c@{kpf.c}}
\doxysubsubsection{\texorpdfstring{xpf\_setup\_fileset\_sections()}{xpf\_setup\_fileset\_sections()}}
{\footnotesize\ttfamily int xpf\+\_\+setup\+\_\+fileset\+\_\+sections (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Sets up XPF fileset kernel sections for the IMG4 Kext. 

\begin{DoxyReturn}{Returns}
Zero on success 
\end{DoxyReturn}
